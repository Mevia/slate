
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Mevia REST API</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;json&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="json">JSON</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#overview" class="toc-h1 toc-link" data-title="overview">Overview</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#authentication-and-security" class="toc-h2 toc-link" data-title="authentication-and-security">Authentication and security</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#resources" class="toc-h1 toc-link" data-title="resources">Resources</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#flag-policies" class="toc-h2 toc-link" data-title="flag-policies">Flag Policies</a>
                  </li>
                    <ul class="toc-list-h3">
                        <li>
                          <a href="#attributes" class="toc-h3 toc-link" data-title="Resources">Attributes</a>
                        </li>
                        <li>
                          <a href="#relationships" class="toc-h3 toc-link" data-title="Resources">Relationships</a>
                        </li>
                        <li>
                          <a href="#filters" class="toc-h3 toc-link" data-title="Resources">Filters</a>
                        </li>
                        <li>
                          <a href="#available-resources" class="toc-h3 toc-link" data-title="Resources">Available resources</a>
                        </li>
                    </ul>
                  <li>
                    <a href="#flags" class="toc-h2 toc-link" data-title="flags">Flags</a>
                  </li>
                    <ul class="toc-list-h3">
                        <li>
                          <a href="#attributes-2" class="toc-h3 toc-link" data-title="Resources">Attributes</a>
                        </li>
                        <li>
                          <a href="#relationships-2" class="toc-h3 toc-link" data-title="Resources">Relationships</a>
                        </li>
                        <li>
                          <a href="#filters-2" class="toc-h3 toc-link" data-title="Resources">Filters</a>
                        </li>
                        <li>
                          <a href="#available-resources-2" class="toc-h3 toc-link" data-title="Resources">Available resources</a>
                        </li>
                    </ul>
                  <li>
                    <a href="#mia-modules" class="toc-h2 toc-link" data-title="mia-modules">Mia Modules</a>
                  </li>
                    <ul class="toc-list-h3">
                        <li>
                          <a href="#attributes-3" class="toc-h3 toc-link" data-title="Resources">Attributes</a>
                        </li>
                        <li>
                          <a href="#relationships-3" class="toc-h3 toc-link" data-title="Resources">Relationships</a>
                        </li>
                        <li>
                          <a href="#filters-3" class="toc-h3 toc-link" data-title="Resources">Filters</a>
                        </li>
                        <li>
                          <a href="#available-resources-3" class="toc-h3 toc-link" data-title="Resources">Available resources</a>
                        </li>
                    </ul>
                  <li>
                    <a href="#notification-policies" class="toc-h2 toc-link" data-title="notification-policies">Notification Policies</a>
                  </li>
                    <ul class="toc-list-h3">
                        <li>
                          <a href="#attributes-4" class="toc-h3 toc-link" data-title="Resources">Attributes</a>
                        </li>
                        <li>
                          <a href="#relationships-4" class="toc-h3 toc-link" data-title="Resources">Relationships</a>
                        </li>
                        <li>
                          <a href="#filters-4" class="toc-h3 toc-link" data-title="Resources">Filters</a>
                        </li>
                        <li>
                          <a href="#available-resources-4" class="toc-h3 toc-link" data-title="Resources">Available resources</a>
                        </li>
                    </ul>
                  <li>
                    <a href="#notifications" class="toc-h2 toc-link" data-title="notifications">Notifications</a>
                  </li>
                    <ul class="toc-list-h3">
                        <li>
                          <a href="#attributes-5" class="toc-h3 toc-link" data-title="Resources">Attributes</a>
                        </li>
                        <li>
                          <a href="#relationships-5" class="toc-h3 toc-link" data-title="Resources">Relationships</a>
                        </li>
                        <li>
                          <a href="#filters-5" class="toc-h3 toc-link" data-title="Resources">Filters</a>
                        </li>
                        <li>
                          <a href="#available-resources-5" class="toc-h3 toc-link" data-title="Resources">Available resources</a>
                        </li>
                    </ul>
                  <li>
                    <a href="#packages" class="toc-h2 toc-link" data-title="packages">Packages</a>
                  </li>
                    <ul class="toc-list-h3">
                        <li>
                          <a href="#attributes-6" class="toc-h3 toc-link" data-title="Resources">Attributes</a>
                        </li>
                        <li>
                          <a href="#relationships-6" class="toc-h3 toc-link" data-title="Resources">Relationships</a>
                        </li>
                        <li>
                          <a href="#filters-6" class="toc-h3 toc-link" data-title="Resources">Filters</a>
                        </li>
                        <li>
                          <a href="#available-resources-6" class="toc-h3 toc-link" data-title="Resources">Available resources</a>
                        </li>
                    </ul>
                  <li>
                    <a href="#prescriptions" class="toc-h2 toc-link" data-title="prescriptions">Prescriptions</a>
                  </li>
                    <ul class="toc-list-h3">
                        <li>
                          <a href="#attributes-7" class="toc-h3 toc-link" data-title="Resources">Attributes</a>
                        </li>
                        <li>
                          <a href="#relationships-7" class="toc-h3 toc-link" data-title="Resources">Relationships</a>
                        </li>
                        <li>
                          <a href="#filters-7" class="toc-h3 toc-link" data-title="Resources">Filters</a>
                        </li>
                        <li>
                          <a href="#available-resources-7" class="toc-h3 toc-link" data-title="Resources">Available resources</a>
                        </li>
                    </ul>
                  <li>
                    <a href="#recipients" class="toc-h2 toc-link" data-title="recipients">Recipients</a>
                  </li>
                    <ul class="toc-list-h3">
                        <li>
                          <a href="#attributes-8" class="toc-h3 toc-link" data-title="Resources">Attributes</a>
                        </li>
                        <li>
                          <a href="#relationships-8" class="toc-h3 toc-link" data-title="Resources">Relationships</a>
                        </li>
                        <li>
                          <a href="#filters-8" class="toc-h3 toc-link" data-title="Resources">Filters</a>
                        </li>
                        <li>
                          <a href="#available-resources-8" class="toc-h3 toc-link" data-title="Resources">Available resources</a>
                        </li>
                    </ul>
                  <li>
                    <a href="#scheduled-dose-schemas" class="toc-h2 toc-link" data-title="scheduled-dose-schemas">Scheduled dose schemas</a>
                  </li>
                    <ul class="toc-list-h3">
                        <li>
                          <a href="#attributes-9" class="toc-h3 toc-link" data-title="Resources">Attributes</a>
                        </li>
                        <li>
                          <a href="#relationships-9" class="toc-h3 toc-link" data-title="Resources">Relationships</a>
                        </li>
                        <li>
                          <a href="#filters-9" class="toc-h3 toc-link" data-title="Resources">Filters</a>
                        </li>
                        <li>
                          <a href="#available-resources-9" class="toc-h3 toc-link" data-title="Resources">Available resources</a>
                        </li>
                    </ul>
                  <li>
                    <a href="#scheduled-doses" class="toc-h2 toc-link" data-title="scheduled-doses">Scheduled doses</a>
                  </li>
                    <ul class="toc-list-h3">
                        <li>
                          <a href="#attributes-10" class="toc-h3 toc-link" data-title="Resources">Attributes</a>
                        </li>
                        <li>
                          <a href="#relationships-10" class="toc-h3 toc-link" data-title="Resources">Relationships</a>
                        </li>
                        <li>
                          <a href="#filters-10" class="toc-h3 toc-link" data-title="Resources">Filters</a>
                        </li>
                        <li>
                          <a href="#available-resources-10" class="toc-h3 toc-link" data-title="Resources">Available resources</a>
                        </li>
                    </ul>
                  <li>
                    <a href="#taken-pods" class="toc-h2 toc-link" data-title="taken-pods">Taken pods</a>
                  </li>
                    <ul class="toc-list-h3">
                        <li>
                          <a href="#attributes-11" class="toc-h3 toc-link" data-title="Resources">Attributes</a>
                        </li>
                        <li>
                          <a href="#relationships-11" class="toc-h3 toc-link" data-title="Resources">Relationships</a>
                        </li>
                        <li>
                          <a href="#filters-11" class="toc-h3 toc-link" data-title="Resources">Filters</a>
                        </li>
                        <li>
                          <a href="#available-resources-11" class="toc-h3 toc-link" data-title="Resources">Available resources</a>
                        </li>
                    </ul>
              </ul>
          </li>
          <li>
            <a href="#flag-types" class="toc-h1 toc-link" data-title="flag-types">Flag types</a>
          </li>
          <li>
            <a href="#notification-triggers" class="toc-h1 toc-link" data-title="notification-triggers">Notification Triggers</a>
          </li>
          <li>
            <a href="#releases" class="toc-h1 toc-link" data-title="releases">Releases</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#development" class="toc-h2 toc-link" data-title="development">Development</a>
                  </li>
                  <li>
                    <a href="#production" class="toc-h2 toc-link" data-title="production">Production</a>
                  </li>
              </ul>
          </li>
      </div>
        <ul class="toc-footer">
            <li><a href='http://www.mevia.se'>Mevia</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='overview'>Overview</h1>
<p>The API aims to take care of all data related to the MIA module itself, which is sending and receiving information from modules. Developers that use the API can, for instance, obtain all events from a module for a given patient, or register a prescription for a patient which then automatically will set reminders and other logic that interacts with the patient&#39;s mobile phone. This page contains general information about the API, what models are available and what the latest changes are. Documentation about all available resources can be found at <a href="resources.html">the resource page</a></p>

<p>The purpose of this setup is that API users will be able to concentrate on their business logic, henceforth not on how the modules work, which is abstracted away through the API. A benefit of this is also that, if the physical module changes, then there will be no impact on API users due to this abstraction.</p>

<p>We follow <a href="http://jsonapi.org">JSON API 1.0</a>. Details about sorting, filtering, resource inclusion and so on will be easiest to find at their site.</p>

<p>The api is available under <span class="red-text">https://api.mevia.se</span>. Current version is scoped under V2.</p>
<h2 id='authentication-and-security'>Authentication and security</h2>
<p>All API calls are done via HTTPS requests, which means that all data obtained and retrieved from the API is delivered through an encrypted connection. Moreover, JSON Web Tokens(&quot;jwt&quot;) are used for authorization, and a jwt must be included with each request in order to authorize with the API. The token is used to idenfify which user that is connecting to the API and is initially handed out manually by Mevia.</p>

<p>In order to authorize with the API, the jwt must be sent with each request as a request parameter in the request header.</p>

<p>The jwt should be specified in the header of every request, in the following fashion:</p>

<p><span class="red-text">Authorization: Bearer <em>your_jwt</em></span></p>
<h1 id='resources'>Resources</h1><h2 id='flag-policies'>Flag Policies</h2>
<p>A flag policy is used to monitor a specific type of <a href="#flag-types">Event</a> in the system. All such events generates a <a href="#flags">Flag</a>, if the type of the flag matches the value of flag_type in a flag policy, all recipients will be notified.</p>

<blockquote>
<p>Example fetch payload (for GET v2/flag_policies)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1337</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"flag_policies"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Your message goes here"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"flag_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"LOW_BATTERY"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}],</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"record_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='attributes'>Attributes</h3>
<blockquote>
<p>Example post payload (POST v2/flag_policies)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"flag_policies"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Your message goes here"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"flag_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"LOW_BATTERY"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"relationships"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"prescription"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"prescriptions"</span><span class="p">,</span><span class="w"> </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="w"> </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Format/Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Integer</td>
<td>ID of the flag policy</td>
</tr>
<tr>
<td>message</td>
<td>String/Text</td>
<td>Message sent to recipients when flag of matching flag_type occurs. If not specified, a default message will be sent.</td>
</tr>
<tr>
<td>flag_type</td>
<td>String</td>
<td>Type of flag to listen for. See <a href="#flag-types">Flag Types</a></td>
</tr>
</tbody></table>
<h3 id='relationships'>Relationships</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Relation</th>
<th>Comments</th>
</tr>
</thead><tbody>
<tr>
<td>prescription</td>
<td>belongs_to</td>
<td></td>
</tr>
<tr>
<td>recipients</td>
<td>has_many</td>
<td>Recipients to notify when a flag of flag_type occurs</td>
</tr>
<tr>
<td>flags</td>
<td>has_many</td>
<td>All flags of flag_type belonging to prescription</td>
</tr>
</tbody></table>
<h3 id='filters'>Filters</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>message</td>
<td>Equal to</td>
</tr>
<tr>
<td>flag_type</td>
<td>Equal to</td>
</tr>
</tbody></table>
<h3 id='available-resources'>Available resources</h3>
<ul>
<li>get/</li>
<li>get/:id</li>
<li>post/</li>
<li>put/:id</li>
<li>delete/:id</li>
</ul>
<h2 id='flags'>Flags</h2>
<p>Flags are created automatically in response to various events occurring in the system. In order to register as a listener to a certain flag, users should create <a href="#flag-policies">flag policies</a>. To find what flags exists, please read the <a href="/#flag-types">flag types</a>&gt; section of this documentation.</p>

<blockquote>
<p>Example fetch payload (for GET v2/flags)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1337</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"flags"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"flag_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"LOW_BATTERY"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"severity"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A descriptive message that can be passed to users if wanted"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-06-29"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}],</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"record_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
  </span><span class="p">},</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='attributes-2'>Attributes</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Format/Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Integer</td>
<td>ID of the flag policy</td>
</tr>
<tr>
<td>description</td>
<td>String/Text</td>
<td>Description of what has happened.</td>
</tr>
<tr>
<td>flag_type</td>
<td>String</td>
<td>See <a href="/#flag-types">Flag Types</a></td>
</tr>
</tbody></table>
<h3 id='relationships-2'>Relationships</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Relation</th>
<th>Comments</th>
</tr>
</thead><tbody>
<tr>
<td>prescription</td>
<td>belongs_to</td>
<td></td>
</tr>
<tr>
<td>flagable</td>
<td>belongs_to</td>
<td>The object that was flagged, i.e, the device with low battery, the dose that was taken early, etc.</td>
</tr>
<tr>
<td>flag_policies</td>
<td>has_many</td>
<td>All policies of matching type belonging to the same prescription</td>
</tr>
</tbody></table>
<h3 id='filters-2'>Filters</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>flag_type</td>
<td>Equal to</td>
</tr>
<tr>
<td>severity</td>
<td>Equal to</td>
</tr>
<tr>
<td>description</td>
<td>Equal to</td>
</tr>
<tr>
<td>created_at</td>
<td>Equal to</td>
</tr>
</tbody></table>
<h3 id='available-resources-2'>Available resources</h3>
<ul>
<li>get/</li>
<li>get/:id</li>
</ul>
<h2 id='mia-modules'>Mia Modules</h2>
<p>The following resources explains basic interaction with MIA Modules.</p>
<h3 id='attributes-3'>Attributes</h3>
<blockquote>
<p>Example fetch payload (for GET v2/mia_modules)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1337</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mia_modules"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GAA001"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"is_connected_to_package"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-09-13T10:50:26.339Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2019-04-27T01:59:01.629Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"battery_percentage"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}],</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"record_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Format/Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Integer</td>
<td>ID of the mia module</td>
</tr>
<tr>
<td>name</td>
<td>String/Text</td>
<td>Name of the mia module</td>
</tr>
<tr>
<td>is_connected_to_package</td>
<td>Boolean</td>
<td>If the device is currently connected to a package</td>
</tr>
<tr>
<td>battery_percentage</td>
<td>Integer</td>
<td>Battery status of the device (at last communication cycle)</td>
</tr>
</tbody></table>
<h3 id='relationships-3'>Relationships</h3>
<blockquote>
<p>Example post request</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mia_modules"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GAA001"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"is_connected_to_package"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Relation</th>
<th>Comments</th>
</tr>
</thead><tbody>
<tr>
<td>prescription</td>
<td>belongs_to</td>
<td></td>
</tr>
<tr>
<td>api_user</td>
<td>belongs_to</td>
<td>Owner of the device</td>
</tr>
<tr>
<td>packages</td>
<td>has_many</td>
<td>All packages that has ever been connected to the device</td>
</tr>
<tr>
<td>taken_pods</td>
<td>has_many</td>
<td>All pods taken with the device connected</td>
</tr>
<tr>
<td>mia_module_schedules</td>
<td>has_many</td>
<td>All active/future schedules</td>
</tr>
</tbody></table>
<h3 id='filters-3'>Filters</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>is_connected_to_package</td>
<td>Equal to</td>
<td></td>
</tr>
<tr>
<td>name</td>
<td>Equal to</td>
<td></td>
</tr>
<tr>
<td>module_number</td>
<td>Equal to</td>
<td></td>
</tr>
<tr>
<td>battery_percentage</td>
<td>Equal to</td>
<td></td>
</tr>
<tr>
<td>Available</td>
<td>Equal to (Boolean)</td>
<td>True if device is not connected to an active prescription</td>
</tr>
</tbody></table>
<h3 id='available-resources-3'>Available resources</h3>
<ul>
<li>get/</li>
<li>get/:id</li>
</ul>
<h2 id='notification-policies'>Notification Policies</h2>
<p>A notification policy is a rule for how to send reminders to a list of recipients. Reminders are sent for every scheduled dose, as long as the dose is not marked as muted/taken when the reminder is supposed to be sent.</p>

<blockquote>
<p>Example fetch payload (for GET v2/notification_policies)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1337</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"notification_policies"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Your message goes here"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"trigger"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BEFORE_DOSE_END"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"offset"</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w">
      </span><span class="s2">"notification_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EMAIL"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"dispatchable"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}],</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"record_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='attributes-4'>Attributes</h3>
<blockquote>
<p>Example post payload (POST v2/flag_policies)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"flag_policies"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Your message goes here"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"trigger"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BEFORE_DOSE_END"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"offset"</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w">
      </span><span class="s2">"notification_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EMAIL"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"relationships"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"prescription"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"prescriptions"</span><span class="p">,</span><span class="w"> </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="w"> </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"recipients"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"recipients"</span><span class="p">,</span><span class="w"> </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"recipients"</span><span class="p">,</span><span class="w"> </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">}]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Format/Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Integer</td>
<td>ID of the notification policy</td>
</tr>
<tr>
<td>message</td>
<td>String/Text</td>
<td>Message sent to recipients at offset (attribute) from trigger (attribute) for every dose beloning to the same prescription.</td>
</tr>
<tr>
<td>notification_type</td>
<td>String</td>
<td>How to dispatch the reminder. Currently, only SMS and EMAIL are supported.</td>
</tr>
<tr>
<td>trigger</td>
<td>String</td>
<td>When to dispatch the reminder. See <a href="#notification-triggers">triggers</a></td>
</tr>
<tr>
<td>offset</td>
<td>Integer</td>
<td>How long before/after trigger (attribute) to send reminder. A reminder with offset 5 and trigger BEFORE_DOSE_START will be dispatched 5 minutes before the dose begins, etc.</td>
</tr>
<tr>
<td>dispatchable</td>
<td>Boolean</td>
<td>Only fetchable. True if the policy is able to dispatch reminders - when there is at least one recipient connected to the policy with data enough to recieve the reminder. If notification_type is set to SMS, a phone is needed. If notification_type is set to EMAIL, an email adress is needed.</td>
</tr>
</tbody></table>
<h3 id='relationships-4'>Relationships</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Relation</th>
<th>Comments</th>
</tr>
</thead><tbody>
<tr>
<td>prescription</td>
<td>belongs_to</td>
<td></td>
</tr>
<tr>
<td>recipients</td>
<td>has_many</td>
<td>Recipients to notify when dose is not taken/muted at specified time</td>
</tr>
<tr>
<td>notifications</td>
<td>has_many</td>
<td>All notifications dispatched by the policy</td>
</tr>
<tr>
<td>scheduled_doses</td>
<td>has_many</td>
<td>All doses for which the recipients will be notified (currently: all doses beloning to the same prescription)</td>
</tr>
</tbody></table>
<h3 id='filters-4'>Filters</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>trigger</td>
<td>Equal to</td>
</tr>
<tr>
<td>message</td>
<td>Equal to</td>
</tr>
<tr>
<td>offset</td>
<td>Equal to</td>
</tr>
<tr>
<td>notification_type</td>
<td>Equal to</td>
</tr>
</tbody></table>
<h3 id='available-resources-4'>Available resources</h3>
<ul>
<li>get/</li>
<li>get/:id</li>
<li>post/</li>
<li>put/:id</li>
<li>delete/:id</li>
</ul>
<h2 id='notifications'>Notifications</h2>
<p>A notification is simply a reminder sent from the system, via a notification policy. One notification is created for every pair of dose schemas, recipients and doses.
* Warning: notifications will be drastically changed in the future. Be careful when using. *</p>

<blockquote>
<p>Example fetch payload (for GET v2/notifications)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1337</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"notifications"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Your message goes here"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"sent_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-02-14T06:45:04.589Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0761133316"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}],</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"record_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
  </span><span class="p">},</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='attributes-5'>Attributes</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Format/Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Integer</td>
<td>ID of the notification</td>
</tr>
<tr>
<td>message</td>
<td>String/Text</td>
<td>Message sent to recipient. Inherited from its notification policy</td>
</tr>
<tr>
<td>email</td>
<td>String</td>
<td>The email to which it was dispatched. A notification will have either a phone number or an email, never both</td>
</tr>
<tr>
<td>phone</td>
<td>String</td>
<td>The phone to which it was dispatched. A notification will have either a phone number or an email, never both</td>
</tr>
</tbody></table>
<h3 id='relationships-5'>Relationships</h3>
<p>None</p>
<h3 id='filters-5'>Filters</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Equal to</td>
</tr>
<tr>
<td>message</td>
<td>Equal to</td>
</tr>
<tr>
<td>email</td>
<td>Equal to</td>
</tr>
<tr>
<td>phone</td>
<td>Equal to</td>
</tr>
</tbody></table>
<h3 id='available-resources-5'>Available resources</h3>
<ul>
<li>get/</li>
<li>get/:id</li>
</ul>
<h2 id='packages'>Packages</h2>
<p>A package is automatically generated whenever a device detects that a new package has been inserted. Packages are read-only, and is mainly used to group taken_pods.</p>

<blockquote>
<p>Example fetch payload (for GET v2/packages)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1337</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"packages"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-02-14T06:45:04.589Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"is_current"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"number"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="s2">"nr_of_taken_pods"</span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}],</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"record_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
  </span><span class="p">},</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='attributes-6'>Attributes</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Format/Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Integer</td>
<td>ID of the package</td>
</tr>
<tr>
<td>created_at</td>
<td>Timestamp</td>
<td>Timestamp of when the package was generated</td>
</tr>
<tr>
<td>is_current</td>
<td>Boolean</td>
<td>Indicates if the package is the latest generated from its device (i.e., it&#39;s currently inserted and in use)</td>
</tr>
<tr>
<td>number</td>
<td>Integer</td>
<td>Index of the package in the list of all packages generated by the device</td>
</tr>
</tbody></table>
<h3 id='relationships-6'>Relationships</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Relation</th>
<th>Comments</th>
</tr>
</thead><tbody>
<tr>
<td>prescription</td>
<td>belongs_to</td>
<td></td>
</tr>
<tr>
<td>recipients</td>
<td>has_many</td>
<td>Recipients to notify when dose is not taken/muted at specified time</td>
</tr>
<tr>
<td>notifications</td>
<td>has_many</td>
<td>All notifications dispatched by the policy</td>
</tr>
<tr>
<td>scheduled_doses</td>
<td>has_many</td>
<td>All doses for which the recipients will be notified (currently: all doses beloning to the same prescription)</td>
</tr>
</tbody></table>
<h3 id='filters-6'>Filters</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Equal to</td>
</tr>
<tr>
<td>created_at</td>
<td>Equal to</td>
</tr>
<tr>
<td>number</td>
<td>Equal to</td>
</tr>
<tr>
<td>nr_of_taken_pods</td>
<td>Equal to</td>
</tr>
</tbody></table>
<h3 id='available-resources-6'>Available resources</h3>
<ul>
<li>get/</li>
<li>get/:id</li>
</ul>
<h2 id='prescriptions'>Prescriptions</h2>
<p>A prescription is easiest to think of as a patient. A prescription is the owner of dose schedules, reminder policies and recipients.</p>

<blockquote>
<p>Example fetch payload (for GET v2/prescriptions)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"105"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"prescriptions"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"links"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"self"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.mevia.se/v2/prescriptions/105"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"starts_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-11-06T00:00:00.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"ends_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-08-31T21:59:00.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"module_activity_starts_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-11-06T00:00:00.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"module_activity_ends_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-08-31T21:59:00.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"pod_sequence"</span><span class="p">:</span><span class="w"> </span><span class="s2">"[0,1,2,3,4,5,6,7,8,9,10,11,12,13]"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"patient_reference"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bertil"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"language"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sv"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}],</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"record_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='attributes-7'>Attributes</h3>
<blockquote>
<p>Example post payload (for POST v2/prescriptions)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"prescriptions"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"starts_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-11-06T00:00:00.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"ends_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-08-31T21:59:00.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"module_activity_starts_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-11-06T00:00:00.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"module_activity_ends_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-08-31T21:59:00.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"pod_sequence"</span><span class="p">:</span><span class="w"> </span><span class="s2">"[0,1,2,3,4,5,6,7,8,9,10,11,12,13]"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"patient_reference"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bertil"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"language"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sv"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Format/Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Integer</td>
<td>ID of the prescription</td>
</tr>
<tr>
<td>starts_at</td>
<td>Timestamp</td>
<td>Indicator of when the prescriptions turns active - doses and reminders starts to generate etc.</td>
</tr>
<tr>
<td>ends_at</td>
<td>Timestamp</td>
<td>Indicator of when the prescriptions turns inactive - doses and reminders no longer generate etc.</td>
</tr>
<tr>
<td>module_activity_starts_at</td>
<td>Timestamp</td>
<td>If users want data of device activity before start of prescription, this attribute can be set to an earlier time. Doses and reminders will not start, but a log of taken_pods will be created by the device, if such activity occurs.</td>
</tr>
<tr>
<td>module_activity_ends_at</td>
<td>Timestamp</td>
<td>Same as above, but after prescriptions end.</td>
</tr>
<tr>
<td>pod_sequence</td>
<td>String(array)</td>
<td>The order of which taken_pods are to be taken. If sequence does not matter (all pods contain same dose for example), leave empty.</td>
</tr>
<tr>
<td>patient_reference</td>
<td>String</td>
<td>The name of the patient. Used in some of the default flag messages</td>
</tr>
<tr>
<td>language</td>
<td>String</td>
<td>The language the patient prefers. Current supports only sv and en. Default flag descriptions will be sent using this language.</td>
</tr>
</tbody></table>
<h3 id='relationships-7'>Relationships</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Relation</th>
<th>Comments</th>
</tr>
</thead><tbody>
<tr>
<td>organization</td>
<td>belongs_to</td>
<td>Owner of the prescription</td>
</tr>
<tr>
<td>mia_modules</td>
<td>has_many</td>
<td>All devices used by the prescription.</td>
</tr>
<tr>
<td>flag_policies</td>
<td>has_many</td>
<td>All flag policies in use. If a recipient is present on the policy, all flags of matching type under the prescription will be dispatched to the recipient</td>
</tr>
<tr>
<td>notification_policies</td>
<td>has_many</td>
<td>All notification policies in use. If a recipient is present on the policy, all doses that are not taken/muted under the prescription will dispatch a reminder to the recipient</td>
</tr>
<tr>
<td>scheduled_doses</td>
<td>has_many</td>
<td>All doses generated by the prescriptions dose schemas</td>
</tr>
<tr>
<td>scheduled_dose_schemas</td>
<td>has many</td>
<td>All dose schemas beloning to the prescription.</td>
</tr>
<tr>
<td>recipients</td>
<td>has_many</td>
<td>All recipients belonging to the prescription. Recipients are not in use unless also connected to a flag_policy or notification_policy.</td>
</tr>
<tr>
<td>packages</td>
<td>has_many</td>
<td>All packages created by the prescriptions mia_modules.</td>
</tr>
<tr>
<td>taken_pods</td>
<td>has_many</td>
<td>All taken_pods generated by the prescriptions mia_modules</td>
</tr>
<tr>
<td>notifications</td>
<td>has_many</td>
<td>All notifications sent under the prescription (for doses, notification_policies and recipients belonging to the prescription)</td>
</tr>
<tr>
<td>flags</td>
<td>has_many</td>
<td>All flags that has occured under the prescription. Will be created even if no matching flag_policy exists (can be displayed without being dispatched)</td>
</tr>
<tr>
<td>mia_module_schedules</td>
<td>has_many</td>
<td>All mia_module_schedules belonging to the prescriptions mia_modules. Used to manage temporary module ownerships.</td>
</tr>
</tbody></table>
<h3 id='filters-7'>Filters</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Type       Description</th>
</tr>
</thead><tbody>
<tr>
<td>starts_at</td>
<td>Equal to</td>
</tr>
<tr>
<td>ends_at</td>
<td>Equal to</td>
</tr>
<tr>
<td>module_activity_starts_at</td>
<td>Equal to</td>
</tr>
<tr>
<td>module_activity_ends_at</td>
<td>Equal to</td>
</tr>
<tr>
<td>pod_sequence</td>
<td>Equal to</td>
</tr>
<tr>
<td>patient_reference</td>
<td>Equal to</td>
</tr>
<tr>
<td>language</td>
<td>Equal to</td>
</tr>
<tr>
<td>active</td>
<td>Equal to</td>
</tr>
<tr>
<td>with_patient_reference_like</td>
<td>Matches</td>
</tr>
</tbody></table>
<h3 id='available-resources-7'>Available resources</h3>
<ul>
<li>get/</li>
<li>get/:id</li>
<li>put/:id</li>
<li>post</li>
<li>delete/:id</li>
</ul>
<h2 id='recipients'>Recipients</h2>
<p>A recipient is a receiver of notifications and flags. A prescription can have several. Easiest to think of as a contact in a contact list.</p>

<blockquote>
<p>Example fetch payload (for GET v2/recipients)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"105"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"recipients"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"links"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"self"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.mevia.se/v2/recipients/105"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bertil"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456789"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example@mevia.se"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}],</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"record_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='attributes-8'>Attributes</h3>
<blockquote>
<p>Example post payload (for POST v2/recipients)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"recipients"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bertil"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456789"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example@mevia.se"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Format/Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Integer</td>
<td>ID of the recipient</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>Name of the recipient. Used for display purposes only (never used in default messages etc.).</td>
</tr>
<tr>
<td>phone</td>
<td>String</td>
<td>Phone number used to receive sms messages</td>
</tr>
<tr>
<td>email</td>
<td>String</td>
<td>Email address used to receive emails</td>
</tr>
</tbody></table>
<h3 id='relationships-8'>Relationships</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Relation</th>
<th>Comments</th>
</tr>
</thead><tbody>
<tr>
<td>prescription</td>
<td>belongs_to</td>
<td>Owner of the recipient</td>
</tr>
<tr>
<td>flag_policies</td>
<td>has_many</td>
<td>Recipient will be notified when a flag is created matching the flag_type of the policy</td>
</tr>
<tr>
<td>notification_policies</td>
<td>has_many</td>
<td>Recipient will be reminded when a dose matches the criteria of the policy</td>
</tr>
</tbody></table>
<h3 id='filters-8'>Filters</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>phone</td>
<td>Equal to</td>
</tr>
<tr>
<td>name</td>
<td>Equal to</td>
</tr>
<tr>
<td>email</td>
<td>Equal to</td>
</tr>
</tbody></table>
<h3 id='available-resources-8'>Available resources</h3>
<ul>
<li>get/</li>
<li>get/:id</li>
<li>put/:id</li>
<li>post</li>
<li>delete/:id</li>
</ul>
<h2 id='scheduled-dose-schemas'>Scheduled dose schemas</h2>
<p>A dose schema is a set of rules on how to generate scheduled doses for its prescription.
Several attributes will be added in the next version of the API. Keep them in mind when building stuff using schemas :)</p>

<blockquote>
<p>Example fetch payload (for GET v2/scheduled_dose_schemas)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"220"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"scheduled_dose_schemas"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"links"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"self"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.mevia.se/v2/scheduled_dose_schemas/220"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"start_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"14:30"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"end_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"pod_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="s2">"start_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-11-06"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"end_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-12-31"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"days_between_doses"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="s2">"prescription_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">105</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"relationships"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"scheduled_doses"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"links"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"self"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.mevia.se/v2/scheduled_dose_schemas/220/relationships/scheduled_doses"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"related"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.mevia.se/v2/scheduled_dose_schemas/220/scheduled_doses"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"prescription"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"links"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"self"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.mevia.se/v2/scheduled_dose_schemas/220/relationships/prescription"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"related"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.mevia.se/v2/scheduled_dose_schemas/220/prescription"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}],</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"record_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='attributes-9'>Attributes</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Format/Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Integer</td>
<td>ID of the dose schema</td>
</tr>
<tr>
<td>start_time</td>
<td>String(HH:MM)</td>
<td>Specifies at what time generated doses should start</td>
</tr>
<tr>
<td>end_time</td>
<td>String(HH:MM)</td>
<td>Specifies at what time generated doses should end</td>
</tr>
<tr>
<td>pod_amount</td>
<td>Integer</td>
<td>Specifies what amount of pods/doses should be taken during the dose period.</td>
</tr>
<tr>
<td>start_date</td>
<td>Date</td>
<td>First day to apply scheduling rules on</td>
</tr>
<tr>
<td>end_date</td>
<td>Date</td>
<td>Last day to apply scheduling rules on</td>
</tr>
<tr>
<td>days_between_doses</td>
<td>Integer</td>
<td>Days between doses. 2 will generate a dose every other day, 7 will generate a weekly dose etc.</td>
</tr>
</tbody></table>
<h3 id='relationships-9'>Relationships</h3>
<blockquote>
<p>Example post payload (for POST v2/scheduled_dose_schemas)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"scheduled_dose_schemas"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"start_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"14:30"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"end_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15:00"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"pod_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="s2">"start_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-11-06"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"end_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-12-31"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"days_between_doses"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="s2">"prescription_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">105</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Relation</th>
<th>Comments</th>
</tr>
</thead><tbody>
<tr>
<td>prescription</td>
<td>belongs_to</td>
<td></td>
</tr>
<tr>
<td>recipients</td>
<td>has_many</td>
<td>Recipients to notify when dose is not taken/muted at specified time</td>
</tr>
<tr>
<td>notifications</td>
<td>has_many</td>
<td>All notifications dispatched by the policy</td>
</tr>
<tr>
<td>scheduled_doses</td>
<td>has_many</td>
<td>All doses for which the recipients will be notified (currently: all doses beloning to the same prescription)</td>
</tr>
</tbody></table>
<h3 id='filters-9'>Filters</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Equal to</td>
</tr>
<tr>
<td>start_time</td>
<td>Equal to</td>
</tr>
<tr>
<td>end_time</td>
<td>Equal to</td>
</tr>
<tr>
<td>pod_amount</td>
<td>Equal to</td>
</tr>
<tr>
<td>start_date</td>
<td>Equal to</td>
</tr>
<tr>
<td>end_date</td>
<td>Equal to</td>
</tr>
<tr>
<td>days_between_doses</td>
<td>Equal to</td>
</tr>
</tbody></table>
<h3 id='available-resources-9'>Available resources</h3>
<ul>
<li>get/</li>
<li>get/:id</li>
<li>post</li>
<li>put/:id</li>
<li>delete/:id</li>
</ul>
<h2 id='scheduled-doses'>Scheduled doses</h2>
<p>A scheduled dose is a planned period of time during which its prescription is supposed to take one or more pods/doses.</p>

<blockquote>
<p>Example fetch payload (for GET v2/scheduled_doses)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15154"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"scheduled_doses"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"links"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"self"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.mevia.se/v2/scheduled_doses/15154"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"period_starts_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-11-06T13:30:00.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"period_ends_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-11-06T14:00:00.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"taken"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"completed_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-11-06T13:49:22.245Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"nr_remaining_pods"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"expected_pods"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"muted"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"nr_remaining_pods_until_mute"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"scheduled_dose_schema_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">220</span><span class="p">,</span><span class="w">
      </span><span class="s2">"prescription_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">105</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"relationships"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"scheduled_dose_schema"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"links"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"self"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.mevia.se/v2/scheduled_doses/15154/relationships/scheduled_dose_schema"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"related"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.mevia.se/v2/scheduled_doses/15154/scheduled_dose_schema"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"prescription"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"links"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"self"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.mevia.se/v2/scheduled_doses/15154/relationships/prescription"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"related"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.mevia.se/v2/scheduled_doses/15154/prescription"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"notifications"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"links"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"self"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.mevia.se/v2/scheduled_doses/15154/relationships/notifications"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"related"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.mevia.se/v2/scheduled_doses/15154/notifications"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"taken_pods"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"links"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"self"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.mevia.se/v2/scheduled_doses/15154/relationships/taken_pods"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"related"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.mevia.se/v2/scheduled_doses/15154/taken_pods"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}],</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"record_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='attributes-10'>Attributes</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Format/Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Integer</td>
<td>ID of the dose</td>
</tr>
<tr>
<td>period_starts_at</td>
<td>Datetime</td>
<td>Specifies at what time the dose starts</td>
</tr>
<tr>
<td>period_ends_at</td>
<td>Datetime</td>
<td>Specifies at what time the dose ends</td>
</tr>
<tr>
<td>taken</td>
<td>Boolean</td>
<td>True if the dose has been taken correctly, otherwise false</td>
</tr>
<tr>
<td>completed_at</td>
<td>Datetime</td>
<td>Time at which the dose was completed <em>correctly</em></td>
</tr>
<tr>
<td>nr_remaining_pods</td>
<td>Integer</td>
<td>How many doses left until dose is taken <em>correctly</em></td>
</tr>
<tr>
<td>nr_remaining_pods_until_mute</td>
<td>Boolean</td>
<td>How many doses left until dose is marked as muted (doesn&#39;t care if the pods/doses were taken correctly). A dose with this set to 0 will not send any more notifications</td>
</tr>
<tr>
<td>expected_pods</td>
<td>String(array)</td>
<td>The pods that are supposed to be taken during this dose period. Only set if prescription has a pod_sequence.</td>
</tr>
<tr>
<td>muted</td>
<td>Boolean</td>
<td>Same behaviour as if nr_remaining_pods_until_mute reaches zero, but manually toggled.</td>
</tr>
</tbody></table>
<h3 id='relationships-10'>Relationships</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Relation</th>
<th>Comments</th>
</tr>
</thead><tbody>
<tr>
<td>prescription</td>
<td>belongs_to</td>
<td></td>
</tr>
<tr>
<td>taken_pods</td>
<td>has_many</td>
<td>All pods related to this dose. Decided either by timestamp of the pod or by its sequence number</td>
</tr>
<tr>
<td>notifications</td>
<td>has_many</td>
<td>All notifications/reminders sent regarding this dose</td>
</tr>
<tr>
<td>scheduled_dose_schema</td>
<td>belongs_to</td>
<td>The schema which generated this dose</td>
</tr>
</tbody></table>
<h3 id='filters-10'>Filters</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Equal to</td>
<td></td>
</tr>
<tr>
<td>period_starts_at</td>
<td>Equal to</td>
<td></td>
</tr>
<tr>
<td>period_ends_at</td>
<td>Equal to</td>
<td></td>
</tr>
<tr>
<td>taken</td>
<td>Equal to</td>
<td></td>
</tr>
<tr>
<td>completed_at</td>
<td>Equal to</td>
<td></td>
</tr>
<tr>
<td>nr_remaining_pods</td>
<td>Equal to</td>
<td></td>
</tr>
<tr>
<td>nr_remaining_pods_until_mute</td>
<td>Equal to</td>
<td></td>
</tr>
<tr>
<td>expected_pods</td>
<td>Equal to</td>
<td></td>
</tr>
<tr>
<td>muted</td>
<td>Equal to</td>
<td></td>
</tr>
<tr>
<td>pod_number</td>
<td>Matches</td>
<td>Given a list of numbers, returns all doses in which all numbers are expected</td>
</tr>
<tr>
<td>date_to</td>
<td>Less than or equal to</td>
<td>Given a datetime, returns all doses ending before that datetime</td>
</tr>
<tr>
<td>date_from</td>
<td>Greater than or equal to</td>
<td>Given a datetime, returns all doses starting after that datetime</td>
</tr>
</tbody></table>
<h3 id='available-resources-10'>Available resources</h3>
<ul>
<li>get/</li>
<li>get/:id</li>
<li>post</li>
<li>put/:id</li>
<li>delete/:id</li>
</ul>
<h2 id='taken-pods'>Taken pods</h2>
<p>A taken pod is generated by a mia_module whenever its owner removes a pill/dose/pod from its package.</p>

<blockquote>
<p>Example fetch payload (for GET v2/taken_pods)</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"13590"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"taken_pods"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"links"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"self"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.mevia.se/v2/taken_pods/13590"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"number"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
      </span><span class="s2">"taken_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-11-06T12:28:56.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"prescription_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">105</span><span class="p">,</span><span class="w">
      </span><span class="s2">"scheduled_dose_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="s2">"package_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">4893</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"relationships"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"prescription"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"links"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"self"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.mevia.se/v2/taken_pods/13590/relationships/prescription"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"related"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.mevia.se/v2/taken_pods/13590/prescription"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"scheduled_dose"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"links"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"self"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.mevia.se/v2/taken_pods/13590/relationships/scheduled_dose"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"related"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.mevia.se/v2/taken_pods/13590/scheduled_dose"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"package"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"links"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"self"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.mevia.se/v2/taken_pods/13590/relationships/package"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"related"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://api.mevia.se/v2/taken_pods/13590/package"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}],</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"record_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='attributes-11'>Attributes</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Format/Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>Integer</td>
<td>ID of the pod</td>
</tr>
<tr>
<td>number</td>
<td>Integer</td>
<td>The index (in its package) of the pod. Used to match against its prescriptions pod_sequence, if used</td>
</tr>
<tr>
<td>taken_at</td>
<td>Datetime</td>
<td>Specifies at what time the pod was taken</td>
</tr>
</tbody></table>
<h3 id='relationships-11'>Relationships</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Relation</th>
<th>Comments</th>
</tr>
</thead><tbody>
<tr>
<td>prescription</td>
<td>belongs_to</td>
<td></td>
</tr>
<tr>
<td>package</td>
<td>belongs_to</td>
<td></td>
</tr>
<tr>
<td>mia_module</td>
<td>belongs_to</td>
<td></td>
</tr>
<tr>
<td>scheduled_dose</td>
<td>belongs_to</td>
<td></td>
</tr>
</tbody></table>
<h3 id='filters-11'>Filters</h3>
<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
</tr>
</thead><tbody>
<tr>
<td>taken_at</td>
<td>Equal to</td>
</tr>
<tr>
<td>Number</td>
<td>Equal to</td>
</tr>
</tbody></table>
<h3 id='available-resources-11'>Available resources</h3>
<ul>
<li>get/</li>
<li>get/:id</li>
</ul>
<h1 id='flag-types'>Flag types</h1>
<p>This is a list of all flags that currently exists in the system. Flags are simply events occuring in the system that users can chose to be notified about.</p>

<table><thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>When is it sent?</th>
</tr>
</thead><tbody>
<tr>
<td>LOW_BATTERY</td>
<td>A device is low on battery.</td>
<td>When a device has a battery status &lt; 20%</td>
</tr>
<tr>
<td>SEQUENCE_ANOMALY</td>
<td>A pod was taken in the wrong order</td>
<td>When a patient takes a pod that is not the next expected pod</td>
</tr>
<tr>
<td>OUTSIDE_DOSE_INTERVAL</td>
<td>A pod was taken outside of any existing dose</td>
<td>When a patient takes a pod outside of any existing scheduled dose</td>
</tr>
<tr>
<td>ADHERENCE_ANOMALY</td>
<td>Someting went wrong from a adherence perspective</td>
<td>Whenever a adherence-related flag (currently: OUTSIDE_DOSE_INTERVAL and SEQUENCE_ANOMALY) is created.</td>
</tr>
<tr>
<td>DISCONNECTED_DEVICE</td>
<td>A device was disconnected right before user dose started</td>
<td>~30 minutes before start of a dose if user has a disconnected device</td>
</tr>
<tr>
<td>DELAYED_COMMUNICATION</td>
<td>A device failed to communicate for 24.5 hours or more.</td>
<td>Whenever a device has failed to communicate for an entire day (24 hours)</td>
</tr>
<tr>
<td>TAKEN_EARLY</td>
<td>A pill was taken before its dose window (within 15 minutes of start)</td>
<td>Whenever a pill is taken for a prescription not using pod sequence is taken within 15 minutes of dose start</td>
</tr>
<tr>
<td>TAKEN_LATE</td>
<td>A pill was taken after its dose window (within 15 minutes of end)</td>
<td>Whenever a pill is taken for a prescription not using pod sequence is taken within 15 minutes of dose end</td>
</tr>
<tr>
<td>TAKEN_INSIDE_TAKEN_DOSE</td>
<td>A pill was taken inside of a dose that was already completed</td>
<td>Whenever a pill is taken for a prescription not using pod sequence inside of a dose that is already completed</td>
</tr>
</tbody></table>
<h1 id='notification-triggers'>Notification Triggers</h1>
<p>This is a list of all existing notification trigger. A trigger is set on a notification policy, and is used to know when to create notifications.</p>

<table><thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>When is the notification sent?</th>
</tr>
</thead><tbody>
<tr>
<td>BEFORE_DOSE_STARTS</td>
<td>Used to create notifications before doses starts</td>
<td>x minutes before the doses start, where x is the offset variable on the notification policy</td>
</tr>
<tr>
<td>BEFORE_DOSE_ENDS</td>
<td>Used to create notifications before doses ends</td>
<td>x minutes before the doses start, where x is the offset variable on the notification policy</td>
</tr>
<tr>
<td>AFTER_DOSE_END</td>
<td>Used to create notifications after doses ends</td>
<td>x minutes before the doses ends, where x is the offset variable on the notification policy</td>
</tr>
</tbody></table>

<p>Example: A notification policy with trigger: &#39;BEFORE_DOSE_ENDS&#39; and offset: 15, and a scheduled_dose_schema with start_time: &#39;10:00&#39; and end_time: &#39;11:00&#39; will generate a notification that is scheduled to be sent at 10:45 every day that its prescription is active.</p>
<h1 id='releases'>Releases</h1><h2 id='development'>Development</h2><h2 id='production'>Production</h2>
      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="json">JSON</a>
          </div>
      </div>
    </div>
  </body>
</html>
